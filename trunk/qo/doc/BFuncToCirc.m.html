<html>
<head>
<title>~/quantum-octave/BFuncToCirc.m.html</title>
<meta name="Generator" content="Vim/6.2">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2">
</head>
<body bgcolor="#ffffff" text="#000000">
<pre>
<font color="#0000ff">## -*- texinfo -*-</font>
<font color="#0000ff">## @deftypefn{Function file} {} BFuncToCirc(@var{sizea},@var{sizev},@var{values})</font>
<font color="#0000ff">## Function @code{BFunToCirc} </font>
<font color="#0000ff">## @end deftypefn</font>
<font color="#0000ff">## @seealso {}</font>
<font color="#0000ff">## </font>
<font color="#0000ff">## Author: Piotr Gawron, Jaroslaw Miszczak.</font>
<font color="#0000ff">## Created: 9 June 2004.</font>

<font color="#a52a2a"><b>function</b></font> ret = BFuncToCirc<font color="#008b8b">(</font>sizea, sizev, values<font color="#008b8b">)</font>
<font color="#a52a2a"><b>if</b></font><font color="#008b8b">(</font><font color="#008b8b">nargin</font><font color="#a52a2a"><b>!=</b></font><font color="#ff00ff">3</font><font color="#008b8b">)</font>
    usage<font color="#008b8b">(</font><font color="#ff00ff">&quot;BFuncToCirc(sizea, sizev, values)&quot;</font><font color="#008b8b">)</font>;
<font color="#a52a2a"><b>endif</b></font>

<font color="#a52a2a"><b>if</b></font><font color="#008b8b">(</font>size<font color="#008b8b">(</font>values<font color="#008b8b">)(</font><font color="#ff00ff">2</font><font color="#008b8b">)</font><font color="#a52a2a"><b>!=</b></font><font color="#ff00ff">2</font><font color="#a52a2a"><b>^</b></font>sizea<font color="#008b8b">)</font>
    error<font color="#008b8b">(</font><font color="#ff00ff">&quot;Wrong number of values!&quot;</font><font color="#008b8b">)</font>;
<font color="#a52a2a"><b>endif</b></font>

<font color="#a52a2a"><b>if</b></font><font color="#008b8b">(</font>max<font color="#008b8b">(</font>values<font color="#008b8b">)</font><font color="#a52a2a"><b>&gt;</b></font><font color="#ff00ff">2</font><font color="#a52a2a"><b>^</b></font>sizev<font color="#a52a2a"><b>-</b></font><font color="#ff00ff">1</font><font color="#008b8b">)</font>
    error<font color="#008b8b">(</font><font color="#ff00ff">&quot;Not enough qubits for given values!&quot;</font><font color="#008b8b">)</font>;
<font color="#a52a2a"><b>endif</b></font>

valueMatrix=zeros<font color="#008b8b">(</font>sizev,<font color="#ff00ff">2</font><font color="#a52a2a"><b>^</b></font>sizea<font color="#008b8b">)</font>;
gates = list<font color="#008b8b">()</font>;

<font color="#0000ff">#for each value put its binary representation into matrix</font>
<font color="#a52a2a"><b>for</b></font> i=<font color="#008b8b">[</font><font color="#ff00ff">1</font>:<font color="#ff00ff">2</font><font color="#a52a2a"><b>^</b></font>sizea<font color="#008b8b">]</font>
    valueMatrix<font color="#008b8b">(</font>:,i<font color="#008b8b">)</font> = Dec2BinVec<font color="#008b8b">(</font>values<font color="#008b8b">(</font>i<font color="#008b8b">)</font>,sizev<font color="#008b8b">)</font><font color="#a52a2a"><b>'</b></font> ;<font color="#0000ff"># we want it to have vertical vectors</font>
<font color="#a52a2a"><b>endfor</b></font>

<font color="#a52a2a"><b>for</b></font> j=<font color="#008b8b">[</font><font color="#ff00ff">1</font>:sizev<font color="#008b8b">]</font> <font color="#0000ff"># for each output qubit</font>
    <font color="#a52a2a"><b>for</b></font> i=<font color="#008b8b">[</font><font color="#ff00ff">1</font>:<font color="#ff00ff">2</font><font color="#a52a2a"><b>^</b></font>sizea<font color="#008b8b">]</font> <font color="#0000ff"># for each value</font>
        <font color="#a52a2a"><b>if</b></font><font color="#008b8b">(</font>valueMatrix<font color="#008b8b">(</font>j,i<font color="#008b8b">)</font><font color="#a52a2a"><b>==</b></font><font color="#ff00ff">1</font><font color="#008b8b">)</font>
<font color="#0000ff">#*</font>          <font color="#0000ff">qubit = j</font>
            idx = Dec2BinVec<font color="#008b8b">(</font>i<font color="#a52a2a"><b>-</b></font><font color="#ff00ff">1</font>,sizea<font color="#008b8b">)</font><font color="#a52a2a"><b>'</b></font>
            notpos=<font color="#a52a2a"><b>-</b></font><font color="#ff00ff">1</font>;
<font color="#0000ff"># we prepare vector of not gates positions</font>
<font color="#0000ff">#*</font>          <font color="#0000ff">idx</font>
            l=<font color="#ff00ff">1</font>;
            <font color="#a52a2a"><b>for</b></font> k=<font color="#008b8b">[</font><font color="#ff00ff">1</font>:sizea<font color="#008b8b">]</font>
                <font color="#a52a2a"><b>if</b></font><font color="#008b8b">(</font>idx<font color="#008b8b">(</font>k<font color="#008b8b">)</font><font color="#a52a2a"><b>==</b></font><font color="#ff00ff">0</font><font color="#008b8b">)</font>
                    notpos<font color="#008b8b">(</font>l<font color="#008b8b">)</font>=k;
                    l = l<font color="#a52a2a"><b>+</b></font><font color="#ff00ff">1</font>;
                <font color="#a52a2a"><b>endif</b></font>
            <font color="#a52a2a"><b>endfor</b></font>
            notpos

            gn=Id<font color="#008b8b">(</font>sizea<font color="#a52a2a"><b>+</b></font>sizev<font color="#008b8b">)</font>;
            <font color="#a52a2a"><b>if</b></font><font color="#008b8b">(</font>notpos<font color="#a52a2a"><b>!=</b></font><font color="#a52a2a"><b>-</b></font><font color="#ff00ff">1</font><font color="#008b8b">)</font>
                gn = ProductGate<font color="#008b8b">(</font>sizea<font color="#a52a2a"><b>+</b></font>sizev,Not,notpos<font color="#008b8b">)</font>;
            <font color="#a52a2a"><b>endif</b></font>
            gcn = CNot<font color="#008b8b">(</font>sizea<font color="#a52a2a"><b>+</b></font>sizev, <font color="#008b8b">[</font><font color="#ff00ff">1</font>:sizea<font color="#008b8b">]</font>,sizea<font color="#a52a2a"><b>+</b></font>j<font color="#008b8b">)</font>;
            gate = Circuit<font color="#008b8b">(</font>gn,gcn,gn<font color="#008b8b">)</font>;
            gates = append<font color="#008b8b">(</font>gates,gate<font color="#008b8b">)</font>;
        <font color="#a52a2a"><b>endif</b></font>
    <font color="#a52a2a"><b>endfor</b></font>
<font color="#a52a2a"><b>endfor</b></font>
ret = gates;

<font color="#a52a2a"><b>endfunction</b></font>
</pre>
</body>
</html>
