<html>
<head>
<title>~/quantum-octave/BuildBinaryVector.m.html</title>
<meta name="Generator" content="Vim/6.1">
</head>
<body bgcolor="#e5e5e5" text="#000000">
<pre>
<font color="#a52a2a"> 1</font>  <font color="#0000ff">## -*- texinfo -*-</font>
<font color="#a52a2a"> 2</font>  <font color="#0000ff">## @deftypefn {Function file} {} BuildBinaryVector(@var{indx},@var{binvec},@var{binnum},@var{qubits})</font>
<font color="#a52a2a"> 3</font>  <font color="#0000ff">## Function @code{BuildBinaryVector} returns a  @code{Ket} base vector  in @var{qubits}-qubits Hilbert </font>
<font color="#a52a2a"> 4</font>  <font color="#0000ff">## space labeled with number constructed as follows. Every bit of this number which is listed in @var{indx}</font>
<font color="#a52a2a"> 5</font>  <font color="#0000ff">## is sert according with @var{binnum}, other bits are complemented using @var{binnum}.</font>
<font color="#a52a2a"> 6</font>  <font color="#0000ff">## Note: @var{binvec} and @var{binnum} must be binary vectors such that </font>
<font color="#a52a2a"> 7</font>  <font color="#0000ff">## @code{length of binvec + length of binnum = qubits}.</font>
<font color="#a52a2a"> 8</font>  <font color="#0000ff">## </font>
<font color="#a52a2a"> 9</font>  <font color="#0000ff">## @example </font>
<font color="#a52a2a">10</font>  <font color="#0000ff">## @group</font>
<font color="#a52a2a">11</font>  <font color="#0000ff">## BuildBinaryVector([1,2],[1,0],[1,1],4)</font>
<font color="#a52a2a">12</font>  <font color="#0000ff">##  @result{} </font>
<font color="#a52a2a">13</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">14</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">15</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">16</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">17</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">18</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">19</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">20</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">21</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">22</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">23</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">24</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">25</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">26</font>  <font color="#0000ff">##  1</font>
<font color="#a52a2a">27</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">28</font>  <font color="#0000ff">##  0</font>
<font color="#a52a2a">29</font>  <font color="#0000ff">## @end group</font>
<font color="#a52a2a">30</font>  <font color="#0000ff">## @end example</font>
<font color="#a52a2a">31</font>  <font color="#0000ff">##</font>
<font color="#a52a2a">32</font>  <font color="#0000ff">## @end deftypefn</font>
<font color="#a52a2a">33</font>  <font color="#0000ff">##</font>
<font color="#a52a2a">34</font>  <font color="#0000ff">## @seealso {Id, Not}</font>
<font color="#a52a2a">35</font>  <font color="#0000ff">##</font>
<font color="#a52a2a">36</font>  <font color="#0000ff">## Author: Piotr Gawron, Jaroslaw Miszczak.</font>
<font color="#a52a2a">37</font>  <font color="#0000ff">## Created: 8 March 2005,</font>
<font color="#a52a2a">38</font>  <font color="#0000ff">## Last modyfication: 16 March 2004.</font>
<font color="#a52a2a">39</font>
<font color="#a52a2a">40</font>  <font color="#a52a2a"><b>function</b></font> ret = BuildBinaryVector<font color="#008b8b">(</font>qidx, binvec, binnum, qubits<font color="#008b8b">)</font>
<font color="#a52a2a">41</font>  indx = sort<font color="#008b8b">(</font>qidx<font color="#008b8b">)</font>;
<font color="#a52a2a">42</font>
<font color="#a52a2a">43</font>  is = size<font color="#008b8b">(</font>indx<font color="#008b8b">)(</font><span style="background-color: #f2f2f2"><font color="#ff00ff">2</font></span><font color="#008b8b">)</font>; <font color="#0000ff"># number of bits for substitution</font>
<font color="#a52a2a">44</font>  bs = size<font color="#008b8b">(</font>binvec<font color="#008b8b">)(</font><span style="background-color: #f2f2f2"><font color="#ff00ff">2</font></span><font color="#008b8b">)</font>; <font color="#0000ff"># number of bits in substuitution list</font>
<font color="#a52a2a">45</font>  ns = size<font color="#008b8b">(</font>binnum<font color="#008b8b">)(</font><span style="background-color: #f2f2f2"><font color="#ff00ff">2</font></span><font color="#008b8b">)</font>; <font color="#0000ff">#number of bits in complementation</font>
<font color="#a52a2a">46</font>
<font color="#a52a2a">47</font>  <font color="#0000ff"># test validity of call</font>
<font color="#a52a2a">48</font>
<font color="#a52a2a">49</font>  <font color="#a52a2a"><b>if</b></font> <font color="#008b8b">(</font> is <font color="#a52a2a"><b>!=</b></font> bs <font color="#008b8b">)</font>
<font color="#a52a2a">50</font>      error<font color="#008b8b">(</font><span style="background-color: #f2f2f2"><font color="#ff00ff">&quot;Size of first (=%d) and second argument (=%d) do not match!&quot;</font></span>,is, bs<font color="#008b8b">)</font>;
<font color="#a52a2a">51</font>  <font color="#a52a2a"><b>endif</b></font>
<font color="#a52a2a">52</font>
<font color="#a52a2a">53</font>  <font color="#a52a2a"><b>if</b></font> <font color="#008b8b">(</font> bs <font color="#a52a2a"><b>+</b></font> ns <font color="#a52a2a"><b>!=</b></font> qubits <font color="#008b8b">)</font>
<font color="#a52a2a">54</font>      error<font color="#008b8b">(</font><span style="background-color: #f2f2f2"><font color="#ff00ff">&quot;Wrong number of qubits: size of binvec  = %d, size of binnum = %d, qubits = %d&quot;</font></span>, bs, ns, qubits <font color="#008b8b">)</font>;
<font color="#a52a2a">55</font>  <font color="#a52a2a"><b>endif</b></font>
<font color="#a52a2a">56</font>
<font color="#a52a2a">57</font>  <font color="#a52a2a"><b>if</b></font> <font color="#008b8b">(</font> indx<font color="#008b8b">(</font>is<font color="#008b8b">)</font> <font color="#a52a2a"><b>&gt;</b></font> qubits <font color="#008b8b">)</font>
<font color="#a52a2a">58</font>      error<font color="#008b8b">(</font><span style="background-color: #f2f2f2"><font color="#ff00ff">&quot;Too large qubit index (=%d) in first argument!&quot;</font></span>, indx<font color="#008b8b">(</font>is<font color="#008b8b">))</font>;
<font color="#a52a2a">59</font>  <font color="#a52a2a"><b>endif</b></font>
<font color="#a52a2a">60</font>
<font color="#a52a2a">61</font>  <font color="#0000ff"># local variables for looping over binvec and binnum lists</font>
<font color="#a52a2a">62</font>  qi = <span style="background-color: #f2f2f2"><font color="#ff00ff">1</font></span>;
<font color="#a52a2a">63</font>  bi = <span style="background-color: #f2f2f2"><font color="#ff00ff">1</font></span>;
<font color="#a52a2a">64</font>
<font color="#a52a2a">65</font>  <font color="#0000ff"># build temporary vector</font>
<font color="#a52a2a">66</font>  temp  = zeros<font color="#008b8b">(</font><span style="background-color: #f2f2f2"><font color="#ff00ff">1</font></span>,qubits<font color="#008b8b">)</font>;
<font color="#a52a2a">67</font>
<font color="#a52a2a">68</font>  <font color="#a52a2a"><b>for</b></font> i=<span style="background-color: #f2f2f2"><font color="#ff00ff">1</font></span>:qubits
<font color="#a52a2a">69</font>      <font color="#a52a2a"><b>if</b></font> <font color="#008b8b">(</font> qi <font color="#a52a2a"><b>&lt;=</b></font> is <font color="#a52a2a"><b>&amp;&amp;</b></font> i <font color="#a52a2a"><b>==</b></font> indx<font color="#008b8b">(</font>qi<font color="#008b8b">)</font> <font color="#008b8b">)</font>
<font color="#a52a2a">70</font>          temp<font color="#008b8b">(</font>i<font color="#008b8b">)</font> = binvec<font color="#008b8b">(</font>qi<font color="#008b8b">)</font>;
<font color="#a52a2a">71</font>          qi<font color="#a52a2a"><b>++</b></font>;
<font color="#a52a2a">72</font>      <font color="#a52a2a"><b>elseif</b></font> <font color="#008b8b">(</font> bi <font color="#a52a2a"><b>&lt;=</b></font> ns <font color="#008b8b">)</font>
<font color="#a52a2a">73</font>          temp<font color="#008b8b">(</font>i<font color="#008b8b">)</font> = binnum<font color="#008b8b">(</font>bi<font color="#008b8b">)</font>;
<font color="#a52a2a">74</font>          bi<font color="#a52a2a"><b>++</b></font>;
<font color="#a52a2a">75</font>      <font color="#a52a2a"><b>endif</b></font>
<font color="#a52a2a">76</font>  <font color="#a52a2a"><b>endfor</b></font>
<font color="#a52a2a">77</font>  ret = Ket<font color="#008b8b">(</font>temp<font color="#008b8b">)</font>;
<font color="#a52a2a">78</font>  <font color="#a52a2a"><b>endfunction</b></font>
<font color="#a52a2a">79</font>
</pre>
</body>
</html>
