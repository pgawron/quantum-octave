<html>
<head>
<title>~/quantum-octave/Measure.m.html</title>
<meta name="Generator" content="Vim/6.2">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2">
</head>
<body bgcolor="#ffffff" text="#000000">
<pre>
<font color="#0000ff">## -*- texinfo -*-</font>
<font color="#0000ff">## @deftypefn{Function file} {} Measure(@var{state})</font>
<font color="#0000ff">## Function @code{Measure} performs ortogonal measurment on state @var{state}. Function returns a probability distribution of results. </font>
<font color="#0000ff">## @example </font>
<font color="#0000ff">## @group</font>
<font color="#0000ff">## Measure(State(Ket([1,0,1])))</font>
<font color="#0000ff">##  @result{}</font>
<font color="#0000ff">## 0  0</font>
<font color="#0000ff">## 1  0</font>
<font color="#0000ff">## 2  0</font>
<font color="#0000ff">## 3  0</font>
<font color="#0000ff">## 4  0</font>
<font color="#0000ff">## 5  1</font>
<font color="#0000ff">## 6  0</font>
<font color="#0000ff">## 7  0</font>
<font color="#0000ff">##</font>
<font color="#0000ff">## @end group</font>
<font color="#0000ff">## @end example</font>
<font color="#0000ff">## @end deftypefn</font>
<font color="#0000ff">## @seealso {Id, Not, H, Pase}</font>
<font color="#0000ff">## </font>
<font color="#0000ff">## Author: Piotr Gawron, Jaroslaw Miszczak.</font>
<font color="#0000ff">## Created: 12 December 2003.</font>
<font color="#0000ff">## Last modyfication: 10 February 2004.</font>

<font color="#a52a2a"><b>function</b></font> ret = Measure<font color="#008b8b">(</font>state, observables, str<font color="#008b8b">)</font>
<font color="#0000ff">#</font><span style="background-color: #ffff00"><font color="#0000ff">TODO</font></span><font color="#0000ff"> test if state is valid state and if observables are in form &quot;XYZZYXI&quot;</font>

flag=<font color="#a52a2a"><b>-</b></font><font color="#ff00ff">1</font>; <font color="#0000ff"># 0 - return measured state (default); 1 - return structure</font>

lobservables = observables;


<font color="#a52a2a"><b>if</b></font><font color="#008b8b">(</font><font color="#008b8b">nargin</font><font color="#a52a2a"><b>==</b></font><font color="#ff00ff">2</font><font color="#008b8b">)</font>
    flag=<font color="#ff00ff">0</font>;
<font color="#a52a2a"><b>elseif</b></font><font color="#008b8b">(</font><font color="#008b8b">nargin</font><font color="#a52a2a"><b>==</b></font><font color="#ff00ff">3</font><font color="#008b8b">)</font>
    <font color="#a52a2a"><b>if</b></font><font color="#008b8b">(</font>strcmp<font color="#008b8b">(</font><font color="#ff00ff">&quot;state&quot;</font>,str<font color="#008b8b">))</font>
        flag=<font color="#ff00ff">0</font>;
    <font color="#a52a2a"><b>elseif</b></font><font color="#008b8b">(</font>strcmp<font color="#008b8b">(</font><font color="#ff00ff">&quot;struct&quot;</font>,str<font color="#008b8b">))</font>
        flag=<font color="#ff00ff">1</font>;
    <font color="#a52a2a"><b>else</b></font>
        usage<font color="#008b8b">(</font><font color="#ff00ff">&quot;Measure(state, observables[, {\&quot;</font>state<font color="#a52a2a"><b>\</b></font><font color="#ff00ff">&quot;|\&quot;</font>struct<font color="#a52a2a"><b>\</b></font><font color="#ff00ff">&quot;}])&quot;</font><font color="#008b8b">)</font>;
    <font color="#a52a2a"><b>endif</b></font>
<font color="#a52a2a"><b>else</b></font>
    usage<font color="#008b8b">(</font><font color="#ff00ff">&quot;Measure(state, observables[, {\&quot;</font>state<font color="#a52a2a"><b>\</b></font><font color="#ff00ff">&quot;|\&quot;</font>struct<font color="#a52a2a"><b>\</b></font><font color="#ff00ff">&quot;}])&quot;</font><font color="#008b8b">)</font>;
<font color="#a52a2a"><b>endif</b></font>

qs = log2<font color="#008b8b">(</font>size<font color="#008b8b">(</font>state<font color="#008b8b">)(</font><font color="#ff00ff">2</font><font color="#008b8b">))</font>; <font color="#0000ff"># number of qubits in state</font>

<font color="#a52a2a"><b>if</b></font> <font color="#008b8b">(</font>size<font color="#008b8b">(</font>lobservables<font color="#008b8b">)(</font><font color="#ff00ff">2</font><font color="#008b8b">)</font><font color="#a52a2a"><b>!=</b></font>qs<font color="#008b8b">)</font>
    error<font color="#008b8b">(</font><font color="#ff00ff">&quot;Observables description and state size do not match&quot;</font><font color="#008b8b">)</font>;
<font color="#a52a2a"><b>endif</b></font>


chosestate=false; <font color="#0000ff"># true if we want to return state vector</font>
<font color="#a52a2a"><b>if</b></font> <font color="#008b8b">(</font>flag<font color="#a52a2a"><b>==</b></font><font color="#ff00ff">0</font><font color="#008b8b">)</font>
    chosestate=true;
<font color="#a52a2a"><b>else</b></font>
    chosestate=false;
<font color="#a52a2a"><b>endif</b></font>

lo = length<font color="#008b8b">(</font>lobservables<font color="#008b8b">)</font>;

listobs = {};
<font color="#a52a2a"><b>for</b></font> i=lo<font color="#a52a2a"><b>+</b></font><font color="#ff00ff">1</font><font color="#a52a2a"><b>-</b></font><font color="#008b8b">[</font><font color="#ff00ff">1</font>:lo<font color="#008b8b">]</font>
    <font color="#a52a2a"><b>if</b></font> <font color="#008b8b">(</font>lobservables<font color="#008b8b">(</font>i<font color="#008b8b">)</font><font color="#a52a2a"><b>==</b></font><font color="#ff00ff">&quot;X&quot;</font><font color="#008b8b">)</font>
        listobs<font color="#008b8b">(</font>i<font color="#008b8b">)</font>=Observable<font color="#008b8b">(</font><font color="#ff00ff">0.5</font><font color="#a52a2a"><b>*</b></font>Sx<font color="#008b8b">)</font>;
    <font color="#a52a2a"><b>elseif</b></font> <font color="#008b8b">(</font>lobservables<font color="#008b8b">(</font>i<font color="#008b8b">)</font><font color="#a52a2a"><b>==</b></font><font color="#ff00ff">&quot;Y&quot;</font><font color="#008b8b">)</font>
        listobs<font color="#008b8b">(</font>i<font color="#008b8b">)</font>=Observable<font color="#008b8b">(</font><font color="#ff00ff">0.5</font><font color="#a52a2a"><b>*</b></font>Sy<font color="#008b8b">)</font>;
    <font color="#a52a2a"><b>elseif</b></font> <font color="#008b8b">(</font>lobservables<font color="#008b8b">(</font>i<font color="#008b8b">)</font><font color="#a52a2a"><b>==</b></font><font color="#ff00ff">&quot;Z&quot;</font><font color="#008b8b">)</font>
        listobs<font color="#008b8b">(</font>i<font color="#008b8b">)</font>=Observable<font color="#008b8b">(</font><font color="#ff00ff">0.5</font><font color="#a52a2a"><b>*</b></font>Sz<font color="#008b8b">)</font>;
    <font color="#a52a2a"><b>elseif</b></font> <font color="#008b8b">(</font>lobservables<font color="#008b8b">(</font>i<font color="#008b8b">)</font><font color="#a52a2a"><b>==</b></font><font color="#ff00ff">&quot;I&quot;</font><font color="#008b8b">)</font>
        temp<font color="#008b8b">(</font><font color="#ff00ff">1</font><font color="#008b8b">)</font>.l = <font color="#ff00ff">1</font>;
        temp<font color="#008b8b">(</font><font color="#ff00ff">2</font><font color="#008b8b">)</font>.l = <font color="#ff00ff">1</font>;
        temp<font color="#008b8b">(</font><font color="#ff00ff">1</font><font color="#008b8b">)</font>.proj = Id<font color="#008b8b">(</font><font color="#ff00ff">1</font><font color="#008b8b">)</font>;
        temp<font color="#008b8b">(</font><font color="#ff00ff">2</font><font color="#008b8b">)</font>.proj = Id<font color="#008b8b">(</font><font color="#ff00ff">1</font><font color="#008b8b">)</font>;
        listobs<font color="#008b8b">(</font>i<font color="#008b8b">)</font>=temp;
    <font color="#a52a2a"><b>elseif</b></font>
        error<font color="#008b8b">(</font><font color="#ff00ff">&quot;Unexpected %s found, it should be {X,Y,Z,I}&quot;</font>,observables<font color="#008b8b">(</font>i<font color="#008b8b">))</font>;
    <font color="#a52a2a"><b>endif</b></font>
<font color="#a52a2a"><b>endfor</b></font>

random = rand<font color="#008b8b">()</font>;    <font color="#0000ff"># used during chosing of random output state</font>
cumprob = <font color="#ff00ff">0</font>;        <font color="#0000ff"># cumulative probability</font>

prob.out=<font color="#ff00ff">0</font>;     <font color="#0000ff"># eigenvalue</font>
prob.p=<font color="#ff00ff">0</font>;   <font color="#0000ff"># probability</font>

retstate = zeros<font color="#008b8b">(</font>size<font color="#008b8b">(</font>state<font color="#008b8b">)(</font><font color="#ff00ff">2</font><font color="#008b8b">))</font>; <font color="#0000ff"># state we return</font>
rettemp=<font color="#ff00ff">1</font>;
reteigval=<font color="#a52a2a"><b>-</b></font><font color="#ff00ff">1</font>;

<font color="#a52a2a"><b>for</b></font> j=<font color="#ff00ff">0</font>:<font color="#ff00ff">2</font><font color="#a52a2a"><b>^</b></font>lo<font color="#a52a2a"><b>-</b></font><font color="#ff00ff">1</font> <font color="#0000ff"># for every possible projection</font>
    projection=<font color="#008b8b">[</font><font color="#ff00ff">1</font><font color="#008b8b">]</font>; <font color="#0000ff"># projection operator obtained by spectral decomposition</font>
    indexes = Dec2BinVec<font color="#008b8b">(</font><font color="#ff00ff">2</font><font color="#a52a2a"><b>^</b></font>lo <font color="#a52a2a"><b>-</b></font> j <font color="#a52a2a"><b>-</b></font> <font color="#ff00ff">1</font>,lo<font color="#008b8b">)</font><font color="#a52a2a"><b>+</b></font><font color="#ff00ff">1</font>; <font color="#0000ff"># generation of all combinations of set {1,2}</font>
    prob<font color="#008b8b">(</font>j<font color="#a52a2a"><b>+</b></font><font color="#ff00ff">1</font><font color="#008b8b">)</font>.out=zeros<font color="#008b8b">(</font><font color="#ff00ff">1</font>,lo<font color="#008b8b">)</font>;
    <font color="#a52a2a"><b>for</b></font> i=<font color="#ff00ff">1</font>:lo
        projection = kron<font color="#008b8b">(</font>projection,nth<font color="#008b8b">(</font>listobs,i<font color="#008b8b">)(</font>indexes<font color="#008b8b">(</font>i<font color="#008b8b">))</font>.proj<font color="#008b8b">)</font>;
        prob<font color="#008b8b">(</font>j<font color="#a52a2a"><b>+</b></font><font color="#ff00ff">1</font><font color="#008b8b">)</font>.out<font color="#008b8b">(</font>i<font color="#008b8b">)</font>=nth<font color="#008b8b">(</font>listobs,i<font color="#008b8b">)(</font>indexes<font color="#008b8b">(</font>i<font color="#008b8b">))</font>.l;
        prob<font color="#008b8b">(</font>j<font color="#a52a2a"><b>+</b></font><font color="#ff00ff">1</font><font color="#008b8b">)</font>.out=prob<font color="#008b8b">(</font>j<font color="#a52a2a"><b>+</b></font><font color="#ff00ff">1</font><font color="#008b8b">)</font>.out;
    <font color="#a52a2a"><b>endfor</b></font>
<font color="#0000ff">#*</font>  <font color="#0000ff">projection</font>
    p = trace<font color="#008b8b">(</font>state<font color="#a52a2a"><b>*</b></font>projection<font color="#008b8b">)</font>; <font color="#0000ff"># compute probability </font>
    prob<font color="#008b8b">(</font>j<font color="#a52a2a"><b>+</b></font><font color="#ff00ff">1</font><font color="#008b8b">)</font>.p = p;
    cumprob<font color="#a52a2a"><b>+</b></font>=p; <font color="#0000ff"># to draw state</font>

<font color="#0000ff">#* </font> <font color="#0000ff">STAN = (projection*state*projection)/p</font>

    <font color="#a52a2a"><b>if</b></font><font color="#008b8b">(</font>chosestate <font color="#a52a2a"><b>&amp;&amp;</b></font> <font color="#008b8b">(</font>cumprob<font color="#a52a2a"><b>&gt;</b></font>random<font color="#008b8b">))</font> <font color="#0000ff"># so we are building state after measurment</font>
        chosestate = false;
        rettemp = <font color="#008b8b">(</font>projection<font color="#a52a2a"><b>*</b></font>state<font color="#a52a2a"><b>*</b></font>projection<font color="#008b8b">)</font><font color="#a52a2a"><b>/</b></font>p;
        retstate = rettemp;
        reteigval = prob<font color="#008b8b">(</font>j<font color="#a52a2a"><b>+</b></font><font color="#ff00ff">1</font><font color="#008b8b">)</font>.out;
    <font color="#a52a2a"><b>endif</b></font>
<font color="#a52a2a"><b>endfor</b></font>
<font color="#a52a2a"><b>if</b></font><font color="#008b8b">(</font>flag<font color="#a52a2a"><b>==</b></font><font color="#ff00ff">0</font><font color="#008b8b">)</font>
    ret.state = retstate;
    ret.eigval = reteigval;
<font color="#a52a2a"><b>elseif</b></font><font color="#008b8b">(</font>flag<font color="#a52a2a"><b>==</b></font><font color="#ff00ff">1</font><font color="#008b8b">)</font>
    ret = prob;
<font color="#a52a2a"><b>else</b></font>
    error<font color="#008b8b">(</font><font color="#ff00ff">&quot;Internal error - it should never happen!&quot;</font><font color="#008b8b">)</font>;
<font color="#a52a2a"><b>endif</b></font>
<font color="#a52a2a"><b>endfunction</b></font>
</pre>
</body>
</html>
