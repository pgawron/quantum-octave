<html>
<head>
<title>~/quantum-octave/MixStates.m.html</title>
<meta name="Generator" content="Vim/6.2">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2">
</head>
<body bgcolor="#ffffff" text="#000000">
<pre>
<font color="#8080ff">## -*- texinfo -*-</font>
<font color="#8080ff">## @deftypefn {Function File} {} MixStates (@var{state}, @dots{})</font>
<font color="#8080ff">## This function allow to represent a mixture of mixed states.</font>
<font color="#8080ff">## The argument is a list of density matrices (for example returned</font>
<font color="#8080ff">## by function State). Every density matrix can be preceded by a</font>
<font color="#8080ff">## (complex) number. If no number is specifed the default</font>
<font color="#8080ff">## value 1 is used. If a numbe is specified then it is</font>
<font color="#8080ff">## normalied so that the result would be vaild density matrix.</font>
<font color="#8080ff">## For example:</font>
<font color="#8080ff">## @example</font>
<font color="#8080ff">## @group</font>
<font color="#8080ff">## MixState(State(Ket([0,1])), 0.5, State(Ket([1,0])))</font>
<font color="#8080ff">##  @result{}</font>
<font color="#8080ff">## 0.00000  0.00000  0.00000  0.00000</font>
<font color="#8080ff">## 0.00000  0.66667  0.00000  0.00000</font>
<font color="#8080ff">## 0.00000  0.00000  0.33333  0.00000</font>
<font color="#8080ff">## 0.00000  0.00000  0.00000  0.00000</font>
<font color="#8080ff">## @end group</font>
<font color="#8080ff">## @end example</font>
<font color="#8080ff">## @end deftypefn</font>

<font color="#8080ff">## Author: Piotr Gawron, Jaroslaw Miszczak</font>
<font color="#8080ff">## Created: 25 November 2003</font>

<font color="#ffff00">function</font> ret = MixStates<font color="#00ffff">(</font>varargin<font color="#00ffff">)</font>
NARGIN = <font color="#00ffff">nargin</font>;

summtr = <font color="#ff6060">0</font>;
coef = <font color="#ff6060">1</font>;
sum = <font color="#ff6060">0</font>;

matrix_size = <font color="#00ffff">[</font><font color="#ff6060">0</font>,<font color="#ff6060">0</font><font color="#00ffff">]</font>;

<font color="#ffff00">while</font><font color="#00ffff">(</font>NARGIN<font color="#ffff00">--</font><font color="#00ffff">)</font>
temp = varargin{NARGIN};
    <font color="#ffff00">if</font><font color="#00ffff">(</font>length<font color="#00ffff">(</font>temp<font color="#00ffff">)</font><font color="#ffff00">&gt;</font><font color="#ff6060">1</font><font color="#00ffff">)</font>
        <font color="#ffff00">if</font> <font color="#00ffff">(</font>coef<font color="#ffff00">==</font><font color="#ff6060">1</font><font color="#00ffff">)</font>
                sum<font color="#ffff00">++</font>;
        <font color="#ffff00">endif</font>

        <font color="#ffff00">if</font><font color="#00ffff">(</font>matrix_size<font color="#ffff00">==</font><font color="#00ffff">[</font><font color="#ff6060">0</font>,<font color="#ff6060">0</font><font color="#00ffff">])</font>
            matrix_size = size<font color="#00ffff">(</font>temp<font color="#00ffff">)</font>;
        <font color="#ffff00">elseif</font><font color="#00ffff">(</font>matrix_size<font color="#ffff00">!=</font>size<font color="#00ffff">(</font>temp<font color="#00ffff">))</font>
            error<font color="#00ffff">(</font><font color="#ff6060">&quot;Matrices have to be the same size&quot;</font><font color="#00ffff">)</font>;
        <font color="#ffff00">elseif</font><font color="#00ffff">(</font>size<font color="#00ffff">(</font>temp<font color="#00ffff">)(</font><font color="#ff6060">1</font><font color="#00ffff">)</font><font color="#ffff00">!=</font>size<font color="#00ffff">(</font>temp<font color="#00ffff">)(</font><font color="#ff6060">2</font><font color="#00ffff">))</font>
            error<font color="#00ffff">(</font><font color="#ff6060">&quot;Matrices have to be square&quot;</font><font color="#00ffff">)</font>;
        <font color="#ffff00">elseif</font><font color="#00ffff">(</font>floor<font color="#00ffff">(</font>log2<font color="#00ffff">(</font>size<font color="#00ffff">(</font>temp<font color="#00ffff">)))</font><font color="#ffff00">!=</font>ceil<font color="#00ffff">(</font>log2<font color="#00ffff">(</font>size<font color="#00ffff">(</font>temp<font color="#00ffff">))))</font>
            error<font color="#00ffff">(</font><font color="#ff6060">&quot;Matrices have to be size 2^n x 2^n&quot;</font><font color="#00ffff">)</font>;
        <font color="#ffff00">endif</font>

        summtr<font color="#ffff00">+</font>=coef<font color="#ffff00">.*</font>temp;
        coef=<font color="#ff6060">1</font>;
    <font color="#ffff00">else</font>
        coef=temp;
        sum<font color="#ffff00">+</font>=coef;
    <font color="#ffff00">endif</font>
<font color="#ffff00">endwhile</font>
sum;
ret = summtr<font color="#ffff00">./</font>sum;

<font color="#ffff00">endfunction</font>
</pre>
</body>
</html>
