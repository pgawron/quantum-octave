<html>
<head>
<title>~/quantum-octave/PTrace.m.html</title>
<meta name="Generator" content="Vim/6.2">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2">
</head>
<body bgcolor="#ffffff" text="#000000">
<pre>
<font color="#0000ff">## -*- texinfo -*-</font>
<font color="#0000ff">## @deftypefn {Function file} {} PTrance(state, targv)</font>
<font color="#0000ff">## Function @code{PTrace} returns density matrix obtained</font>
<font color="#0000ff">## from matrix @var{state} by tracing out subspace of qubits</font>
<font color="#0000ff">## listed in @var{targv}.</font>
<font color="#0000ff">##</font>
<font color="#0000ff">## @example </font>
<font color="#0000ff">## @group</font>
<font color="#0000ff">## PTrace(State(Ket([0,0,0])),[1,2])</font>
<font color="#0000ff">##  @result{} </font>
<font color="#0000ff">##</font>  <font color="#0000ff">1 0</font>
<font color="#0000ff">##</font>  <font color="#0000ff">0 0</font>
<font color="#0000ff">## @end group</font>
<font color="#0000ff">## @end example</font>
<font color="#0000ff">##</font>
<font color="#0000ff">## @end deftypefn</font>
<font color="#0000ff">##</font>
<font color="#0000ff">## @seealso {ProductGate, PTranspose}</font>
<font color="#0000ff">##</font>
<font color="#0000ff">## Author: Piotr Gawron, Jaroslaw Miszczak</font>
<font color="#0000ff">## Created: 15 March 2004</font>
<font color="#0000ff">## LAst modyfication: 10 May 2004</font>

<font color="#a52a2a"><b>function</b></font> ret = PTrace<font color="#008b8b">(</font>state,tqidx<font color="#008b8b">)</font>
<font color="#a52a2a"><b>if</b></font> <font color="#008b8b">(</font> <font color="#008b8b">nargin</font> <font color="#a52a2a"><b>!=</b></font> <font color="#ff00ff">2</font> <font color="#008b8b">)</font>
    usage <font color="#008b8b">(</font><font color="#ff00ff">&quot; PTrace (state, trace_qubits)&quot;</font><font color="#008b8b">)</font>;
<font color="#a52a2a"><b>endif</b></font>

targv = sort<font color="#008b8b">(</font>tqidx<font color="#008b8b">)</font>; <font color="#0000ff"># must be sorted!</font>

ss = size<font color="#008b8b">(</font>state<font color="#008b8b">)(</font><font color="#ff00ff">2</font><font color="#008b8b">)</font>; <font color="#0000ff"># dimension of matrix state - always power of 2</font>
sq = log2<font color="#008b8b">(</font>ss<font color="#008b8b">)</font>; <font color="#0000ff"># numer of qubits in matrix state</font>

tq = size<font color="#008b8b">(</font>targv<font color="#008b8b">)(</font><font color="#ff00ff">2</font><font color="#008b8b">)</font>; <font color="#0000ff"># number of qubits to trace-out</font>
ts = <font color="#ff00ff">2</font><font color="#a52a2a"><b>^</b></font>tq;

rq = sq <font color="#a52a2a"><b>-</b></font> tq; <font color="#0000ff"># calculate number of qubits in returned density matrix</font>
rs = <font color="#ff00ff">2</font><font color="#a52a2a"><b>^</b></font>rq; <font color="#0000ff"># calculate size of returned density matrix</font>

ret = zeros <font color="#008b8b">(</font>rs<font color="#008b8b">)</font>; <font color="#0000ff"># inicialize returned density matrix</font>

<font color="#0000ff"># loop over every matrix emelent of returned density matrix</font>
<font color="#a52a2a"><b>for</b></font> i = <font color="#ff00ff">1</font>:rs
    <font color="#a52a2a"><b>for</b></font> j = <font color="#ff00ff">1</font>:rs
        bi = ReverseVec<font color="#008b8b">((</font>Dec2BinVec<font color="#008b8b">(</font>i<font color="#a52a2a"><b>-</b></font><font color="#ff00ff">1</font>,rq<font color="#008b8b">)))</font>; <font color="#0000ff"># those have to be row vectors</font>
        <span clas="">bj = ReverseVec</span><font color="#008b8b">(</font>Dec2BinVec<font color="#008b8b">(</font>j<font color="#a52a2a"><b>-</b></font><font color="#ff00ff">1</font>,rq<font color="#008b8b">))</font>;
s
    <font color="#0000ff"># sum loop over elements of targv list</font>
        <font color="#a52a2a"><b>for</b></font> k = <font color="#ff00ff">0</font>:ts<font color="#a52a2a"><b>-</b></font><font color="#ff00ff">1</font>
            bk = Dec2BinVec<font color="#008b8b">(</font>k,tq<font color="#008b8b">)</font>;
            BRA = BuildBinaryVector<font color="#008b8b">(</font>targv,bk,bi,sq<font color="#008b8b">)</font><font color="#a52a2a"><b>'</b></font>;
            KET = BuildBinaryVector<font color="#008b8b">(</font>targv,bk,bj,sq<font color="#008b8b">)</font>;
            temp = BRA<font color="#a52a2a"><b>*</b></font><font color="#008b8b">(</font>state<font color="#a52a2a"><b>*</b></font>KET<font color="#008b8b">)</font>;
            ret<font color="#008b8b">(</font>i,j<font color="#008b8b">)</font> <font color="#a52a2a"><b>+</b></font>=  temp;
        <font color="#a52a2a"><b>endfor</b></font>
    <font color="#a52a2a"><b>endfor</b></font>
<font color="#a52a2a"><b>endfor</b></font>
<font color="#a52a2a"><b>endfunction</b></font>
</pre>
</body>
</html>
