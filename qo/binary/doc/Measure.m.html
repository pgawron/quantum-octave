<html>
<head>
<title>~/quantum-octave/Measure.m.html</title>
<meta name="Generator" content="Vim/6.2">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2">
</head>
<body bgcolor="#000040" text="#c0c0c0">
<pre>
<font color="#90f020">  1</font>  <font color="#80a0f8">## -*- texinfo -*-</font>
<font color="#90f020">  2</font>  <font color="#80a0f8">## @deftypefn{Function file} {} Measure(@var{state})</font>
<font color="#90f020">  3</font>  <font color="#80a0f8">## Function @code{Measure} performs ortogonal measurment on state @var{state}. Function returns a probability distribution of results. </font>
<font color="#90f020">  4</font>  <font color="#80a0f8">## @example </font>
<font color="#90f020">  5</font>  <font color="#80a0f8">## @group</font>
<font color="#90f020">  6</font>  <font color="#80a0f8">## Measure(State(Ket([1,0,1])))</font>
<font color="#90f020">  7</font>  <font color="#80a0f8">##  @result{}</font>
<font color="#90f020">  8</font>  <font color="#80a0f8">## 0  0</font>
<font color="#90f020">  9</font>  <font color="#80a0f8">## 1  0</font>
<font color="#90f020"> 10</font>  <font color="#80a0f8">## 2  0</font>
<font color="#90f020"> 11</font>  <font color="#80a0f8">## 3  0</font>
<font color="#90f020"> 12</font>  <font color="#80a0f8">## 4  0</font>
<font color="#90f020"> 13</font>  <font color="#80a0f8">## 5  1</font>
<font color="#90f020"> 14</font>  <font color="#80a0f8">## 6  0</font>
<font color="#90f020"> 15</font>  <font color="#80a0f8">## 7  0</font>
<font color="#90f020"> 16</font>  <font color="#80a0f8">##</font>
<font color="#90f020"> 17</font>  <font color="#80a0f8">## @end group</font>
<font color="#90f020"> 18</font>  <font color="#80a0f8">## @end example</font>
<font color="#90f020"> 19</font>  <font color="#80a0f8">## @end deftypefn</font>
<font color="#90f020"> 20</font>  <font color="#80a0f8">## @seealso {Id, Not, H, Pase}</font>
<font color="#90f020"> 21</font>  <font color="#80a0f8">## </font>
<font color="#90f020"> 22</font>  <font color="#80a0f8">## Author: Piotr Gawron, Jaroslaw Miszczak.</font>
<font color="#90f020"> 23</font>  <font color="#80a0f8">## Created: 12 December 2003.</font>
<font color="#90f020"> 24</font>  <font color="#80a0f8">## Last modyfication: 10 February 2004.</font>
<font color="#90f020"> 25</font>
<font color="#90f020"> 26</font>  <font color="#f8fc60">function</font> ret = Measure<font color="#40fcf8">(</font>state, observables, str<font color="#40fcf8">)</font>
<font color="#90f020"> 27</font>  <font color="#80a0f8">#</font><span style="background-color: #1048d0"><font color="#d04810">TODO</font></span><font color="#80a0f8"> test if state is valid state and if observables are in form &quot;XYZZYXI&quot;</font>
<font color="#90f020"> 28</font>
<font color="#90f020"> 29</font>  flag=<font color="#f8fc60">-</font><font color="#f8a0a0">1</font>; <font color="#80a0f8"># 0 - return measured state vector (default); 1 - return structure</font>
<font color="#90f020"> 30</font>
<font color="#90f020"> 31</font>  <font color="#f8fc60">if</font><font color="#40fcf8">(</font><font color="#40fcf8">nargin</font><font color="#f8fc60">==</font><font color="#f8a0a0">2</font><font color="#40fcf8">)</font>
<font color="#90f020"> 32</font>          flag=<font color="#f8a0a0">0</font>;
<font color="#90f020"> 33</font>  <font color="#f8fc60">elseif</font><font color="#40fcf8">(</font><font color="#40fcf8">nargin</font><font color="#f8fc60">==</font><font color="#f8a0a0">3</font><font color="#40fcf8">)</font>
<font color="#90f020"> 34</font>          <font color="#f8fc60">if</font><font color="#40fcf8">(</font>strcmp<font color="#40fcf8">(</font><font color="#f8a0a0">&quot;vec&quot;</font>,str<font color="#40fcf8">))</font>
<font color="#90f020"> 35</font>                  flag=<font color="#f8a0a0">0</font>;
<font color="#90f020"> 36</font>          <font color="#f8fc60">elseif</font><font color="#40fcf8">(</font>strcmp<font color="#40fcf8">(</font><font color="#f8a0a0">&quot;struct&quot;</font>,str<font color="#40fcf8">))</font>
<font color="#90f020"> 37</font>                  flag=<font color="#f8a0a0">1</font>;
<font color="#90f020"> 38</font>          <font color="#f8fc60">else</font>
<font color="#90f020"> 39</font>                  usage<font color="#40fcf8">(</font><font color="#f8a0a0">&quot;Measure(state, observables[, {\&quot;</font>vec<font color="#f8fc60">\</font><font color="#f8a0a0">&quot;|\&quot;</font>struct<font color="#f8fc60">\</font><font color="#f8a0a0">&quot;}])&quot;</font><font color="#40fcf8">)</font>;
<font color="#90f020"> 40</font>          <font color="#f8fc60">endif</font>
<font color="#90f020"> 41</font>  <font color="#f8fc60">else</font>
<font color="#90f020"> 42</font>          usage<font color="#40fcf8">(</font><font color="#f8a0a0">&quot;Measure(state, observables[, {\&quot;</font>vec<font color="#f8fc60">\</font><font color="#f8a0a0">&quot;|\&quot;</font>struct<font color="#f8fc60">\</font><font color="#f8a0a0">&quot;}])&quot;</font><font color="#40fcf8">)</font>;
<font color="#90f020"> 43</font>  <font color="#f8fc60">endif</font>
<font color="#90f020"> 44</font>
<font color="#90f020"> 45</font>  chosestate=false; <font color="#80a0f8"># true if we want to return state vector</font>
<font color="#90f020"> 46</font>  <font color="#f8fc60">if</font> <font color="#40fcf8">(</font>flag<font color="#f8fc60">==</font><font color="#f8a0a0">0</font><font color="#40fcf8">)</font>
<font color="#90f020"> 47</font>          chosestate=true;
<font color="#90f020"> 48</font>  <font color="#f8fc60">else</font>
<font color="#90f020"> 49</font>          chosestate=false;
<font color="#90f020"> 50</font>  <font color="#f8fc60">endif</font>
<font color="#90f020"> 51</font>
<font color="#90f020"> 52</font>  lo = length<font color="#40fcf8">(</font>observables<font color="#40fcf8">)</font>;
<font color="#90f020"> 53</font>
<font color="#90f020"> 54</font>  listobs = {};
<font color="#90f020"> 55</font>  <font color="#f8fc60">for</font> i=<font color="#f8a0a0">1</font>:lo
<font color="#90f020"> 56</font>          <font color="#f8fc60">if</font> <font color="#40fcf8">(</font>observables<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font><font color="#f8fc60">==</font><font color="#f8a0a0">&quot;X&quot;</font><font color="#40fcf8">)</font>
<font color="#90f020"> 57</font>                  listobs<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font>=Observable<font color="#40fcf8">(</font><font color="#f8a0a0">0.5</font><font color="#f8fc60">*</font>Sx<font color="#40fcf8">)</font>;
<font color="#90f020"> 58</font>          <font color="#f8fc60">elseif</font> <font color="#40fcf8">(</font>observables<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font><font color="#f8fc60">==</font><font color="#f8a0a0">&quot;Y&quot;</font><font color="#40fcf8">)</font>
<font color="#90f020"> 59</font>                  listobs<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font>=Observable<font color="#40fcf8">(</font><font color="#f8a0a0">0.5</font><font color="#f8fc60">*</font>Sy<font color="#40fcf8">)</font>;
<font color="#90f020"> 60</font>          <font color="#f8fc60">elseif</font> <font color="#40fcf8">(</font>observables<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font><font color="#f8fc60">==</font><font color="#f8a0a0">&quot;Z&quot;</font><font color="#40fcf8">)</font>
<font color="#90f020"> 61</font>                  listobs<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font>=Observable<font color="#40fcf8">(</font><font color="#f8a0a0">0.5</font><font color="#f8fc60">*</font>Sz<font color="#40fcf8">)</font>;
<font color="#90f020"> 62</font>          <font color="#f8fc60">elseif</font> <font color="#40fcf8">(</font>observables<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font><font color="#f8fc60">==</font><font color="#f8a0a0">&quot;I&quot;</font><font color="#40fcf8">)</font>
<font color="#90f020"> 63</font>                  listobs<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font>=Observable<font color="#40fcf8">(</font>Id<font color="#40fcf8">)</font>;
<font color="#90f020"> 64</font>          <font color="#f8fc60">elseif</font>
<font color="#90f020"> 65</font>                  error<font color="#40fcf8">(</font><font color="#f8a0a0">&quot;Unexpected %s found, it should be {X,Y,Z,I}&quot;</font>,observables<font color="#40fcf8">(</font>i<font color="#40fcf8">))</font>;
<font color="#90f020"> 66</font>          <font color="#f8fc60">endif</font>
<font color="#90f020"> 67</font>  <font color="#f8fc60">endfor</font>
<font color="#90f020"> 68</font>
<font color="#90f020"> 69</font>  random = rand<font color="#40fcf8">()</font>;        <font color="#80a0f8"># used during chosing of random output state</font>
<font color="#90f020"> 70</font>  cumprob = <font color="#f8a0a0">0</font>; <font color="#80a0f8"># cumulative probability</font>
<font color="#90f020"> 71</font>
<font color="#90f020"> 72</font>  prob.out=<font color="#f8a0a0">0</font>;     <font color="#80a0f8"># eigenvalue</font>
<font color="#90f020"> 73</font>  prob.p=<font color="#f8a0a0">0</font>;       <font color="#80a0f8"># probability</font>
<font color="#90f020"> 74</font>
<font color="#90f020"> 75</font>  retstate = zeros<font color="#40fcf8">(</font>size<font color="#40fcf8">(</font>state<font color="#40fcf8">)(</font><font color="#f8a0a0">2</font><font color="#40fcf8">)</font>,<font color="#f8a0a0">1</font><font color="#40fcf8">)</font>; <font color="#80a0f8"># state we return</font>
<font color="#90f020"> 76</font>  rettemp=<font color="#f8a0a0">1</font>;
<font color="#90f020"> 77</font>
<font color="#90f020"> 78</font>  <font color="#f8fc60">for</font> j=<font color="#f8a0a0">0</font>:<font color="#f8a0a0">2</font><font color="#f8fc60">^</font>lo<font color="#f8fc60">-</font><font color="#f8a0a0">1</font> <font color="#80a0f8"># for every possible projection</font>
<font color="#90f020"> 79</font>          projection=<font color="#40fcf8">[</font><font color="#f8a0a0">1</font><font color="#40fcf8">]</font>; <font color="#80a0f8"># projection operator obtained by spectral decomposition</font>
<font color="#90f020"> 80</font>          indexes = Dec2BinVec<font color="#40fcf8">(</font><font color="#f8a0a0">2</font><font color="#f8fc60">^</font>lo <font color="#f8fc60">-</font> j <font color="#f8fc60">-</font> <font color="#f8a0a0">1</font>,lo<font color="#40fcf8">)</font><font color="#f8fc60">+</font><font color="#f8a0a0">1</font>; <font color="#80a0f8"># generation of all combinations of set {1,2}</font>
<font color="#90f020"> 81</font>          prob<font color="#40fcf8">(</font>j<font color="#f8fc60">+</font><font color="#f8a0a0">1</font><font color="#40fcf8">)</font>.out=zeros<font color="#40fcf8">(</font><font color="#f8a0a0">1</font>,lo<font color="#40fcf8">)</font>;
<font color="#90f020"> 82</font>          <font color="#f8fc60">for</font> i=<font color="#f8a0a0">1</font>:lo
<font color="#90f020"> 83</font>                  projection = kron<font color="#40fcf8">(</font>projection,nth<font color="#40fcf8">(</font>listobs,i<font color="#40fcf8">)(</font>indexes<font color="#40fcf8">(</font>i<font color="#40fcf8">))</font>.proj<font color="#40fcf8">)</font>;
<font color="#90f020"> 84</font>                  prob<font color="#40fcf8">(</font>j<font color="#f8fc60">+</font><font color="#f8a0a0">1</font><font color="#40fcf8">)</font>.out<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font>=nth<font color="#40fcf8">(</font>listobs,i<font color="#40fcf8">)(</font>indexes<font color="#40fcf8">(</font>i<font color="#40fcf8">))</font>.l;
<font color="#90f020"> 85</font>          <font color="#f8fc60">endfor</font>
<font color="#90f020"> 86</font>          p = trace<font color="#40fcf8">(</font>state<font color="#f8fc60">*</font>projection<font color="#40fcf8">)</font>; <font color="#80a0f8"># compute probability </font>
<font color="#90f020"> 87</font>          prob<font color="#40fcf8">(</font>j<font color="#f8fc60">+</font><font color="#f8a0a0">1</font><font color="#40fcf8">)</font>.p = p;
<font color="#90f020"> 88</font>          cumprob<font color="#f8fc60">+</font>=p;
<font color="#90f020"> 89</font>          <font color="#f8fc60">if</font><font color="#40fcf8">(</font>chosestate <font color="#f8fc60">&amp;&amp;</font> <font color="#40fcf8">(</font>cumprob<font color="#f8fc60">&gt;=</font>random<font color="#40fcf8">))</font> <font color="#80a0f8"># so we are building state after measurment</font>
<font color="#90f020"> 90</font>                  chosestate = false;
<font color="#90f020"> 91</font>                  listops={};
<font color="#90f020"> 92</font>                  <font color="#f8fc60">for</font> i=<font color="#f8a0a0">1</font>:lo
<font color="#90f020"> 93</font>                          <font color="#f8fc60">if</font> <font color="#40fcf8">(</font>observables<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font><font color="#f8fc60">==</font><font color="#f8a0a0">&quot;X&quot;</font><font color="#40fcf8">)</font>
<font color="#90f020"> 94</font>                                  listops<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font>=Observable<font color="#40fcf8">(</font><font color="#f8a0a0">0.5</font><font color="#f8fc60">*</font>Sx,<font color="#f8a0a0">&quot;vec&quot;</font><font color="#40fcf8">)</font>;
<font color="#90f020"> 95</font>                          <font color="#f8fc60">elseif</font> <font color="#40fcf8">(</font>observables<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font><font color="#f8fc60">==</font><font color="#f8a0a0">&quot;Y&quot;</font><font color="#40fcf8">)</font>
<font color="#90f020"> 96</font>                                  listops<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font>=Observable<font color="#40fcf8">(</font><font color="#f8a0a0">0.5</font><font color="#f8fc60">*</font>Sy,<font color="#f8a0a0">&quot;vec&quot;</font><font color="#40fcf8">)</font>;
<font color="#90f020"> 97</font>                          <font color="#f8fc60">elseif</font> <font color="#40fcf8">(</font>observables<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font><font color="#f8fc60">==</font><font color="#f8a0a0">&quot;Z&quot;</font><font color="#40fcf8">)</font>
<font color="#90f020"> 98</font>                                  listops<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font>=Observable<font color="#40fcf8">(</font><font color="#f8a0a0">0.5</font><font color="#f8fc60">*</font>Sz,<font color="#f8a0a0">&quot;vec&quot;</font><font color="#40fcf8">)</font>;
<font color="#90f020"> 99</font>                          <font color="#f8fc60">elseif</font> <font color="#40fcf8">(</font>observables<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font><font color="#f8fc60">==</font><font color="#f8a0a0">&quot;I&quot;</font><font color="#40fcf8">)</font>
<font color="#90f020">100</font>                                  listops<font color="#40fcf8">(</font>i<font color="#40fcf8">)</font>=Observable<font color="#40fcf8">(</font>Id,<font color="#f8a0a0">&quot;vec&quot;</font><font color="#40fcf8">)</font>;
<font color="#90f020">101</font>                          <font color="#f8fc60">elseif</font>
<font color="#90f020">102</font>                                  error<font color="#40fcf8">(</font><font color="#f8a0a0">&quot;Unexpected %s found, it should be {X,Y,Z,I}&quot;</font>,observables<font color="#40fcf8">(</font>i<font color="#40fcf8">))</font>;
<font color="#90f020">103</font>                          <font color="#f8fc60">endif</font>
<font color="#90f020">104</font>                  <font color="#f8fc60">endfor</font>
<font color="#90f020">105</font>                  <font color="#f8fc60">for</font> i=<font color="#f8a0a0">1</font>:lo
<font color="#90f020">106</font>                          rettemp = kron<font color="#40fcf8">(</font>rettemp,nth<font color="#40fcf8">(</font>listops,i<font color="#40fcf8">)(</font>indexes<font color="#40fcf8">(</font>i<font color="#40fcf8">))</font>.vec<font color="#40fcf8">)</font>;
<font color="#90f020">107</font>                  <font color="#f8fc60">endfor</font>
<font color="#90f020">108</font>                  retstate = rettemp;
<font color="#90f020">109</font>          <font color="#f8fc60">endif</font>
<font color="#90f020">110</font>  <font color="#f8fc60">endfor</font>
<font color="#90f020">111</font>  <font color="#f8fc60">if</font><font color="#40fcf8">(</font>flag<font color="#f8fc60">==</font><font color="#f8a0a0">0</font><font color="#40fcf8">)</font>
<font color="#90f020">112</font>          ret = retstate;
<font color="#90f020">113</font>  <font color="#f8fc60">elseif</font><font color="#40fcf8">(</font>flag<font color="#f8fc60">==</font><font color="#f8a0a0">1</font><font color="#40fcf8">)</font>
<font color="#90f020">114</font>          ret = prob;
<font color="#90f020">115</font>  <font color="#f8fc60">else</font>
<font color="#90f020">116</font>          error<font color="#40fcf8">(</font><font color="#f8a0a0">&quot;Internal error - it should never happen!&quot;</font><font color="#40fcf8">)</font>;
<font color="#90f020">117</font>  <font color="#f8fc60">endif</font>
<font color="#90f020">118</font>  <font color="#f8fc60">endfunction</font>
</pre>
</body>
</html>
