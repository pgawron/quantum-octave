<html>
<head>
<title>~/quantum-octave/Fidelity.m.html</title>
<meta name="Generator" content="Vim/6.2">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2">
</head>
<body bgcolor="#ffffff" text="#000000">
<pre>
<font color="#8080ff">## -*- texinfo -*-</font>
<font color="#8080ff">## @deftypefn {Function file} {} Fidelity(rho, sigma)</font>
<font color="#8080ff">## Function @code{Fidelity} returns fidelity (distance between)</font>
<font color="#8080ff">## of state @var{rho} vs. @var{sigma}.</font>
<font color="#8080ff">##</font>
<font color="#8080ff">## @end deftypefn</font>
<font color="#8080ff">##</font>
<font color="#8080ff">## @seealso {Encode, Decode, Recover, Entropy, TrNorm}</font>
<font color="#8080ff">##</font>
<font color="#8080ff">## Author: Piotr Gawron, Jaroslaw Miszczak</font>
<font color="#8080ff">## Created: 29 March 2004</font>

<font color="#ffff00">function</font> ret = Fidelity<font color="#00ffff">(</font>rho,sigma<font color="#00ffff">)</font>
<font color="#ffff00">if</font> <font color="#00ffff">(</font><font color="#00ffff">nargin</font><font color="#ffff00">!=</font><font color="#ff6060">2</font><font color="#00ffff">)</font>
    usage<font color="#00ffff">(</font><font color="#ff6060">&quot;Fidelity (rho,sigma)&quot;</font><font color="#00ffff">)</font>;
<font color="#ffff00">endif</font>

sr = size<font color="#00ffff">(</font>rho<font color="#00ffff">)</font>;

lrho = <font color="#ff6060">0</font>;

<font color="#ffff00">if</font><font color="#00ffff">(</font><font color="#ff6060">2</font><font color="#ffff00">.^</font>ceil<font color="#00ffff">(</font>log2<font color="#00ffff">(</font>sr<font color="#00ffff">))</font><font color="#ffff00">==</font>sr <font color="#ffff00">&amp;&amp;</font> sr<font color="#00ffff">(</font><font color="#ff6060">1</font><font color="#00ffff">)</font><font color="#ffff00">==</font>sr<font color="#00ffff">(</font><font color="#ff6060">2</font><font color="#00ffff">))</font> <font color="#8080ff"># it is state</font>
    lrho = rho;
<font color="#ffff00">elseif</font><font color="#00ffff">(</font><font color="#ff6060">2</font><font color="#ffff00">.^</font>ceil<font color="#00ffff">(</font>log2<font color="#00ffff">(</font>sr<font color="#00ffff">))</font><font color="#ffff00">==</font>sr <font color="#ffff00">&amp;&amp;</font> sr<font color="#00ffff">(</font><font color="#ff6060">1</font><font color="#00ffff">)</font><font color="#ffff00">==</font><font color="#ff6060">1</font><font color="#00ffff">)</font> <font color="#8080ff"># it is state vector</font>
    lrho = State<font color="#00ffff">(</font>rho<font color="#00ffff">)</font>;
<font color="#ffff00">else</font>
    error<font color="#00ffff">(</font><font color="#ff6060">&quot;First parameter must be state vector or density matrix!&quot;</font><font color="#00ffff">)</font>
<font color="#ffff00">endif</font>

sqrtrho = sqrtm<font color="#00ffff">(</font>lrho<font color="#00ffff">)</font>;

temp = sqrtrho<font color="#ffff00">*</font>sigma<font color="#ffff00">*</font>sqrtrho;

temp = sqrtm<font color="#00ffff">(</font>temp<font color="#00ffff">)</font>;

ret = trace<font color="#00ffff">(</font>temp<font color="#00ffff">)</font>;

<font color="#ffff00">endfunction</font>
</pre>
</body>
</html>
