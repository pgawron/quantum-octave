<html>
<head>
<title>~/quantum-octave/PTrace.m.html</title>
<meta name="Generator" content="Vim/6.2">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2">
</head>
<body bgcolor="#ffffff" text="#000000">
<pre>
<font color="#8080ff">## -*- texinfo -*-</font>
<font color="#8080ff">## @deftypefn {Function file} {} PTrance(state, targv)</font>
<font color="#8080ff">## Function @code{PTrace} returns density matrix obtained</font>
<font color="#8080ff">## from matrix @var{state} by tracing out subspace of qubits</font>
<font color="#8080ff">## listed in @var{targv}.</font>
<font color="#8080ff">##</font>
<font color="#8080ff">## @example </font>
<font color="#8080ff">## @group</font>
<font color="#8080ff">## PTrace(State(Ket([0,0,0])),[1,2])</font>
<font color="#8080ff">##  @result{} </font>
<font color="#8080ff">##</font>  <font color="#8080ff">1 0</font>
<font color="#8080ff">##</font>  <font color="#8080ff">0 0</font>
<font color="#8080ff">## @end group</font>
<font color="#8080ff">## @end example</font>
<font color="#8080ff">##</font>
<font color="#8080ff">## @end deftypefn</font>
<font color="#8080ff">##</font>
<font color="#8080ff">## @seealso {ProductGate, PTranspose}</font>
<font color="#8080ff">##</font>
<font color="#8080ff">## Author: Piotr Gawron, Jaroslaw Miszczak</font>
<font color="#8080ff">## Created: 15 March 2004</font>

<font color="#ffff00">function</font> ret = PTrace<font color="#00ffff">(</font>state,tqidx<font color="#00ffff">)</font>
targv = sort<font color="#00ffff">(</font>tqidx<font color="#00ffff">)</font>; <font color="#8080ff"># must be sorted!</font>

ss = size<font color="#00ffff">(</font>state<font color="#00ffff">)(</font><font color="#ff6060">2</font><font color="#00ffff">)</font>; <font color="#8080ff"># dimension of matrix state - always power of 2</font>
sq = log2<font color="#00ffff">(</font>ss<font color="#00ffff">)</font>; <font color="#8080ff"># numer of qubits in matrix state</font>

tq = size<font color="#00ffff">(</font>targv<font color="#00ffff">)(</font><font color="#ff6060">2</font><font color="#00ffff">)</font>; <font color="#8080ff"># number of qubits to trace-out</font>
ts = <font color="#ff6060">2</font><font color="#ffff00">^</font>tq;

rq = sq <font color="#ffff00">-</font> tq; <font color="#8080ff"># calculate number of qubits in returned density matrix</font>
rs = <font color="#ff6060">2</font><font color="#ffff00">^</font>rq; <font color="#8080ff"># calculate size of returned density matrix</font>

ret = zeros <font color="#00ffff">(</font>rs<font color="#00ffff">)</font>; <font color="#8080ff"># inicialize returned density matrix</font>

<font color="#8080ff"># loop over every matrix emelent of returned density matrix</font>
<font color="#ffff00">for</font> i = <font color="#ff6060">1</font>:rs
    <font color="#ffff00">for</font> j = <font color="#ff6060">1</font>:rs
        bi = ReverseVec<font color="#00ffff">((</font>Dec2BinVec<font color="#00ffff">(</font>i<font color="#ffff00">-</font><font color="#ff6060">1</font>,rq<font color="#00ffff">)))</font>; <font color="#8080ff"># those have to be row vectors</font>
        bj = ReverseVec<font color="#00ffff">(</font>Dec2BinVec<font color="#00ffff">(</font>j<font color="#ffff00">-</font><font color="#ff6060">1</font>,rq<font color="#00ffff">))</font>;

    <font color="#8080ff"># sum loop over elements of targv list</font>
        <font color="#ffff00">for</font> k = <font color="#ff6060">0</font>:ts<font color="#ffff00">-</font><font color="#ff6060">1</font>
            bk = Dec2BinVec<font color="#00ffff">(</font>k,tq<font color="#00ffff">)</font>;
            BRA = BuildBinaryVector<font color="#00ffff">(</font>targv,bk,bi,sq<font color="#00ffff">)</font><font color="#ffff00">'</font>;
            KET = BuildBinaryVector<font color="#00ffff">(</font>targv,bk,bj,sq<font color="#00ffff">)</font>;
            temp = BRA<font color="#ffff00">*</font><font color="#00ffff">(</font>state<font color="#ffff00">*</font>KET<font color="#00ffff">)</font>;
            ret<font color="#00ffff">(</font>i,j<font color="#00ffff">)</font> <font color="#ffff00">+</font>=  temp;
        <font color="#ffff00">endfor</font>
    <font color="#ffff00">endfor</font>
<font color="#ffff00">endfor</font>
<font color="#ffff00">endfunction</font>
</pre>
</body>
</html>
