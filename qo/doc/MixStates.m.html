<html>
<head>
<title>~/quantum-octave/MixStates.m.html</title>
<meta name="Generator" content="Vim/6.2">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2">
</head>
<body bgcolor="#ffffff" text="#000000">
<pre>
<font color="#0000ff">## -*- texinfo -*-</font>
<font color="#0000ff">## @deftypefn {Function File} {} MixStates (@var{state}, @dots{})</font>
<font color="#0000ff">## This function allow to represent a mixture of mixed states.</font>
<font color="#0000ff">## The argument is a list of density matrices (for example returned</font>
<font color="#0000ff">## by function State). Every density matrix can be preceded by a</font>
<font color="#0000ff">## number. If no number is specifed the default value 1 is used. </font>
<font color="#0000ff">## The result is normalised so that it would be a vaild density matrix.</font>
<font color="#0000ff">## For example:</font>
<font color="#0000ff">## @example</font>
<font color="#0000ff">## @group</font>
<font color="#0000ff">## MixState(State(Ket([0,1])), 0.5, State(Ket([1,0])))</font>
<font color="#0000ff">##  @result{}</font>
<font color="#0000ff">## 0.00000  0.00000  0.00000  0.00000</font>
<font color="#0000ff">## 0.00000  0.66667  0.00000  0.00000</font>
<font color="#0000ff">## 0.00000  0.00000  0.33333  0.00000</font>
<font color="#0000ff">## 0.00000  0.00000  0.00000  0.00000</font>
<font color="#0000ff">## @end group</font>
<font color="#0000ff">## @end example</font>
<font color="#0000ff">## @end deftypefn</font>
<font color="#0000ff">##</font>
<font color="#0000ff">## Author: Piotr Gawron, Jaroslaw Miszczak</font>
<font color="#0000ff">## Created: 25 November 2003</font>
<font color="#0000ff">## Last modyfication: 07 May 2004</font>

<font color="#a52a2a"><b>function</b></font> ret = MixStates<font color="#008b8b">(</font>varargin<font color="#008b8b">)</font>
argc =  <font color="#008b8b">nargin</font>;

<font color="#a52a2a"><b>if</b></font> <font color="#008b8b">(</font>argc <font color="#a52a2a"><b>==</b></font> <font color="#ff00ff">0</font><font color="#008b8b">)</font>
    usage <font color="#008b8b">(</font><font color="#ff00ff">&quot;MixStates ([num,] state [[,num], state] )&quot;</font><font color="#008b8b">)</font>;
<font color="#a52a2a"><b>endif</b></font>

was_scalar = false;
mixs = <font color="#ff00ff">1</font>;

<font color="#0000ff"># buil structure for representing mixture</font>
<font color="#a52a2a"><b>for</b></font> argn = <font color="#ff00ff">1</font>:argc
    <font color="#a52a2a"><b>if</b></font> <font color="#008b8b">(</font> isscalar<font color="#008b8b">(</font>varargin{argn}<font color="#008b8b">)</font> <font color="#008b8b">)</font>
        <font color="#a52a2a"><b>if</b></font> <font color="#008b8b">(</font> was_scalar <font color="#008b8b">)</font>
            error <font color="#008b8b">(</font><font color="#ff00ff">&quot;Wrong form of mixture (two numbers without matrix)!&quot;</font><font color="#008b8b">)</font>;
        <font color="#a52a2a"><b>elseif</b></font> <font color="#008b8b">(</font> <font color="#a52a2a"><b>!</b></font>was_scalar <font color="#008b8b">)</font>
            mixture<font color="#008b8b">(</font>mixs<font color="#008b8b">)</font>.c = varargin{argn};
            was_scalar = true;
        <font color="#a52a2a"><b>endif</b></font>
    <font color="#a52a2a"><b>elseif</b></font> <font color="#008b8b">(</font> issquare<font color="#008b8b">(</font>varargin{argn}<font color="#008b8b">)</font> <font color="#a52a2a"><b>&amp;&amp;</b></font> <font color="#a52a2a"><b>!</b></font>isscalar<font color="#008b8b">(</font>varargin{argn}<font color="#008b8b">)</font> <font color="#008b8b">)</font>
        mixture<font color="#008b8b">(</font>mixs<font color="#008b8b">)</font>.m = varargin{argn};
        <font color="#a52a2a"><b>if</b></font> <font color="#008b8b">(</font> was_scalar <font color="#008b8b">)</font>
            mixture<font color="#008b8b">(</font>mixs<font color="#008b8b">)</font>.c = varargin{argn<font color="#a52a2a"><b>-</b></font><font color="#ff00ff">1</font>};
        <font color="#a52a2a"><b>elseif</b></font> <font color="#008b8b">(</font> <font color="#a52a2a"><b>!</b></font>was_scalar <font color="#008b8b">)</font>
            mixture<font color="#008b8b">(</font>mixs<font color="#008b8b">)</font>.c = <font color="#ff00ff">1</font>;
        <font color="#a52a2a"><b>endif</b></font>
        was_scalar = false;
        mixs<font color="#a52a2a"><b>++</b></font>;
    <font color="#a52a2a"><b>endif</b></font>
<font color="#a52a2a"><b>endfor</b></font>

<font color="#0000ff"># sum components</font>
ret =  zeros<font color="#008b8b">(</font> size<font color="#008b8b">(</font>mixture<font color="#008b8b">(</font><font color="#ff00ff">1</font><font color="#008b8b">)</font>.m<font color="#008b8b">)</font> <font color="#008b8b">)</font>;
<font color="#a52a2a"><b>for</b></font> n = <font color="#ff00ff">1</font>:mixs <font color="#a52a2a"><b>-</b></font> <font color="#ff00ff">1</font>
    ret <font color="#a52a2a"><b>+</b></font>= mixture<font color="#008b8b">(</font>n<font color="#008b8b">)</font>.c<font color="#a52a2a"><b>*</b></font>mixture<font color="#008b8b">(</font>n<font color="#008b8b">)</font>.m ;
<font color="#a52a2a"><b>endfor</b></font>

<font color="#0000ff"># normalize result</font>
ret = ret<font color="#a52a2a"><b>/</b></font>trace<font color="#008b8b">(</font>ret<font color="#008b8b">)</font>;
<font color="#a52a2a"><b>endfunction</b></font>
</pre>
</body>
</html>
