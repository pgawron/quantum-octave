<html>
<head>
<title>~/quantum-octave/Measure.m.html</title>
<meta name="Generator" content="Vim/6.2">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-2">
</head>
<body bgcolor="#ffffff" text="#000000">
<pre>
<font color="#8080ff">## -*- texinfo -*-</font>
<font color="#8080ff">## @deftypefn{Function file} {} Measure(@var{state})</font>
<font color="#8080ff">## Function @code{Measure} performs ortogonal measurment on state @var{state}. Function returns a probability distribution of results. </font>
<font color="#8080ff">## @example </font>
<font color="#8080ff">## @group</font>
<font color="#8080ff">## Measure(State(Ket([1,0,1])))</font>
<font color="#8080ff">##  @result{}</font>
<font color="#8080ff">## 0  0</font>
<font color="#8080ff">## 1  0</font>
<font color="#8080ff">## 2  0</font>
<font color="#8080ff">## 3  0</font>
<font color="#8080ff">## 4  0</font>
<font color="#8080ff">## 5  1</font>
<font color="#8080ff">## 6  0</font>
<font color="#8080ff">## 7  0</font>
<font color="#8080ff">##</font>
<font color="#8080ff">## @end group</font>
<font color="#8080ff">## @end example</font>
<font color="#8080ff">## @end deftypefn</font>
<font color="#8080ff">## @seealso {Id, Not, H, Pase}</font>
<font color="#8080ff">## </font>
<font color="#8080ff">## Author: Piotr Gawron, Jaroslaw Miszczak.</font>
<font color="#8080ff">## Created: 12 December 2003.</font>
<font color="#8080ff">## Last modyfication: 10 February 2004.</font>

<font color="#ffff00">function</font> ret = Measure<font color="#00ffff">(</font>state, observables, str<font color="#00ffff">)</font>
<font color="#8080ff">#</font><span style="background-color: #ffff00"><font color="#808080">TODO</font></span><font color="#8080ff"> test if state is valid state and if observables are in form &quot;XYZZYXI&quot;</font>

flag=<font color="#ffff00">-</font><font color="#ff6060">1</font>; <font color="#8080ff"># 0 - return measured state (default); 1 - return structure</font>

lobservables = observables;


<font color="#ffff00">if</font><font color="#00ffff">(</font><font color="#00ffff">nargin</font><font color="#ffff00">==</font><font color="#ff6060">2</font><font color="#00ffff">)</font>
    flag=<font color="#ff6060">0</font>;
<font color="#ffff00">elseif</font><font color="#00ffff">(</font><font color="#00ffff">nargin</font><font color="#ffff00">==</font><font color="#ff6060">3</font><font color="#00ffff">)</font>
    <font color="#ffff00">if</font><font color="#00ffff">(</font>strcmp<font color="#00ffff">(</font><font color="#ff6060">&quot;state&quot;</font>,str<font color="#00ffff">))</font>
        flag=<font color="#ff6060">0</font>;
    <font color="#ffff00">elseif</font><font color="#00ffff">(</font>strcmp<font color="#00ffff">(</font><font color="#ff6060">&quot;struct&quot;</font>,str<font color="#00ffff">))</font>
        flag=<font color="#ff6060">1</font>;
    <font color="#ffff00">else</font>
        usage<font color="#00ffff">(</font><font color="#ff6060">&quot;Measure(state, observables[, {\&quot;</font>state<font color="#ffff00">\</font><font color="#ff6060">&quot;|\&quot;</font>struct<font color="#ffff00">\</font><font color="#ff6060">&quot;}])&quot;</font><font color="#00ffff">)</font>;
    <font color="#ffff00">endif</font>
<font color="#ffff00">else</font>
    usage<font color="#00ffff">(</font><font color="#ff6060">&quot;Measure(state, observables[, {\&quot;</font>state<font color="#ffff00">\</font><font color="#ff6060">&quot;|\&quot;</font>struct<font color="#ffff00">\</font><font color="#ff6060">&quot;}])&quot;</font><font color="#00ffff">)</font>;
<font color="#ffff00">endif</font>

qs = log2<font color="#00ffff">(</font>size<font color="#00ffff">(</font>state<font color="#00ffff">)(</font><font color="#ff6060">2</font><font color="#00ffff">))</font>; <font color="#8080ff"># number of qubits in state</font>

<font color="#ffff00">if</font> <font color="#00ffff">(</font>size<font color="#00ffff">(</font>lobservables<font color="#00ffff">)(</font><font color="#ff6060">2</font><font color="#00ffff">)</font><font color="#ffff00">!=</font>qs<font color="#00ffff">)</font>
    error<font color="#00ffff">(</font><font color="#ff6060">&quot;Observables description and state size do not match&quot;</font><font color="#00ffff">)</font>;
<font color="#ffff00">endif</font>


chosestate=false; <font color="#8080ff"># true if we want to return state vector</font>
<font color="#ffff00">if</font> <font color="#00ffff">(</font>flag<font color="#ffff00">==</font><font color="#ff6060">0</font><font color="#00ffff">)</font>
    chosestate=true;
<font color="#ffff00">else</font>
    chosestate=false;
<font color="#ffff00">endif</font>

lo = length<font color="#00ffff">(</font>lobservables<font color="#00ffff">)</font>;

listobs = {};
<font color="#ffff00">for</font> i=lo<font color="#ffff00">+</font><font color="#ff6060">1</font><font color="#ffff00">-</font><font color="#00ffff">[</font><font color="#ff6060">1</font>:lo<font color="#00ffff">]</font>
    <font color="#ffff00">if</font> <font color="#00ffff">(</font>lobservables<font color="#00ffff">(</font>i<font color="#00ffff">)</font><font color="#ffff00">==</font><font color="#ff6060">&quot;X&quot;</font><font color="#00ffff">)</font>
        listobs<font color="#00ffff">(</font>i<font color="#00ffff">)</font>=Observable<font color="#00ffff">(</font><font color="#ff6060">0.5</font><font color="#ffff00">*</font>Sx<font color="#00ffff">)</font>;
    <font color="#ffff00">elseif</font> <font color="#00ffff">(</font>lobservables<font color="#00ffff">(</font>i<font color="#00ffff">)</font><font color="#ffff00">==</font><font color="#ff6060">&quot;Y&quot;</font><font color="#00ffff">)</font>
        listobs<font color="#00ffff">(</font>i<font color="#00ffff">)</font>=Observable<font color="#00ffff">(</font><font color="#ff6060">0.5</font><font color="#ffff00">*</font>Sy<font color="#00ffff">)</font>;
    <font color="#ffff00">elseif</font> <font color="#00ffff">(</font>lobservables<font color="#00ffff">(</font>i<font color="#00ffff">)</font><font color="#ffff00">==</font><font color="#ff6060">&quot;Z&quot;</font><font color="#00ffff">)</font>
        listobs<font color="#00ffff">(</font>i<font color="#00ffff">)</font>=Observable<font color="#00ffff">(</font><font color="#ff6060">0.5</font><font color="#ffff00">*</font>Sz<font color="#00ffff">)</font>;
    <font color="#ffff00">elseif</font> <font color="#00ffff">(</font>lobservables<font color="#00ffff">(</font>i<font color="#00ffff">)</font><font color="#ffff00">==</font><font color="#ff6060">&quot;I&quot;</font><font color="#00ffff">)</font>
        temp<font color="#00ffff">(</font><font color="#ff6060">1</font><font color="#00ffff">)</font>.l = <font color="#ff6060">1</font>;
        temp<font color="#00ffff">(</font><font color="#ff6060">2</font><font color="#00ffff">)</font>.l = <font color="#ff6060">1</font>;
        temp<font color="#00ffff">(</font><font color="#ff6060">1</font><font color="#00ffff">)</font>.proj = Id<font color="#00ffff">(</font><font color="#ff6060">1</font><font color="#00ffff">)</font>;
        temp<font color="#00ffff">(</font><font color="#ff6060">2</font><font color="#00ffff">)</font>.proj = Id<font color="#00ffff">(</font><font color="#ff6060">1</font><font color="#00ffff">)</font>;
        listobs<font color="#00ffff">(</font>i<font color="#00ffff">)</font>=temp;
    <font color="#ffff00">elseif</font>
        error<font color="#00ffff">(</font><font color="#ff6060">&quot;Unexpected %s found, it should be {X,Y,Z,I}&quot;</font>,observables<font color="#00ffff">(</font>i<font color="#00ffff">))</font>;
    <font color="#ffff00">endif</font>
<font color="#ffff00">endfor</font>

random = rand<font color="#00ffff">()</font>;    <font color="#8080ff"># used during chosing of random output state</font>
cumprob = <font color="#ff6060">0</font>;        <font color="#8080ff"># cumulative probability</font>

prob.out=<font color="#ff6060">0</font>;     <font color="#8080ff"># eigenvalue</font>
prob.p=<font color="#ff6060">0</font>;   <font color="#8080ff"># probability</font>

retstate = zeros<font color="#00ffff">(</font>size<font color="#00ffff">(</font>state<font color="#00ffff">)(</font><font color="#ff6060">2</font><font color="#00ffff">))</font>; <font color="#8080ff"># state we return</font>
rettemp=<font color="#ff6060">1</font>;
reteigval=<font color="#ffff00">-</font><font color="#ff6060">1</font>;

<font color="#ffff00">for</font> j=<font color="#ff6060">0</font>:<font color="#ff6060">2</font><font color="#ffff00">^</font>lo<font color="#ffff00">-</font><font color="#ff6060">1</font> <font color="#8080ff"># for every possible projection</font>
    projection=<font color="#00ffff">[</font><font color="#ff6060">1</font><font color="#00ffff">]</font>; <font color="#8080ff"># projection operator obtained by spectral decomposition</font>
    indexes = Dec2BinVec<font color="#00ffff">(</font><font color="#ff6060">2</font><font color="#ffff00">^</font>lo <font color="#ffff00">-</font> j <font color="#ffff00">-</font> <font color="#ff6060">1</font>,lo<font color="#00ffff">)</font><font color="#ffff00">+</font><font color="#ff6060">1</font>; <font color="#8080ff"># generation of all combinations of set {1,2}</font>
    prob<font color="#00ffff">(</font>j<font color="#ffff00">+</font><font color="#ff6060">1</font><font color="#00ffff">)</font>.out=zeros<font color="#00ffff">(</font><font color="#ff6060">1</font>,lo<font color="#00ffff">)</font>;
    <font color="#ffff00">for</font> i=<font color="#ff6060">1</font>:lo
        projection = kron<font color="#00ffff">(</font>projection,nth<font color="#00ffff">(</font>listobs,i<font color="#00ffff">)(</font>indexes<font color="#00ffff">(</font>i<font color="#00ffff">))</font>.proj<font color="#00ffff">)</font>;
        prob<font color="#00ffff">(</font>j<font color="#ffff00">+</font><font color="#ff6060">1</font><font color="#00ffff">)</font>.out<font color="#00ffff">(</font>i<font color="#00ffff">)</font>=nth<font color="#00ffff">(</font>listobs,i<font color="#00ffff">)(</font>indexes<font color="#00ffff">(</font>i<font color="#00ffff">))</font>.l;
        prob<font color="#00ffff">(</font>j<font color="#ffff00">+</font><font color="#ff6060">1</font><font color="#00ffff">)</font>.out=prob<font color="#00ffff">(</font>j<font color="#ffff00">+</font><font color="#ff6060">1</font><font color="#00ffff">)</font>.out;
    <font color="#ffff00">endfor</font>
<font color="#8080ff">#*</font>  <font color="#8080ff">projection</font>
    p = trace<font color="#00ffff">(</font>state<font color="#ffff00">*</font>projection<font color="#00ffff">)</font>; <font color="#8080ff"># compute probability </font>
    prob<font color="#00ffff">(</font>j<font color="#ffff00">+</font><font color="#ff6060">1</font><font color="#00ffff">)</font>.p = p;
    cumprob<font color="#ffff00">+</font>=p; <font color="#8080ff"># to draw state</font>

<font color="#8080ff">#* </font> <font color="#8080ff">STAN = (projection*state*projection)/p</font>

    <font color="#ffff00">if</font><font color="#00ffff">(</font>chosestate <font color="#ffff00">&amp;&amp;</font> <font color="#00ffff">(</font>cumprob<font color="#ffff00">&gt;</font>random<font color="#00ffff">))</font> <font color="#8080ff"># so we are building state after measurment</font>
        chosestate = false;
        rettemp = <font color="#00ffff">(</font>projection<font color="#ffff00">*</font>state<font color="#ffff00">*</font>projection<font color="#00ffff">)</font><font color="#ffff00">/</font>p;
        retstate = rettemp;
        reteigval = prob<font color="#00ffff">(</font>j<font color="#ffff00">+</font><font color="#ff6060">1</font><font color="#00ffff">)</font>.out;
    <font color="#ffff00">endif</font>
<font color="#ffff00">endfor</font>
<font color="#ffff00">if</font><font color="#00ffff">(</font>flag<font color="#ffff00">==</font><font color="#ff6060">0</font><font color="#00ffff">)</font>
    ret.state = retstate;
    ret.eigval = reteigval;
<font color="#ffff00">elseif</font><font color="#00ffff">(</font>flag<font color="#ffff00">==</font><font color="#ff6060">1</font><font color="#00ffff">)</font>
    ret = prob;
<font color="#ffff00">else</font>
    error<font color="#00ffff">(</font><font color="#ff6060">&quot;Internal error - it should never happen!&quot;</font><font color="#00ffff">)</font>;
<font color="#ffff00">endif</font>
<font color="#ffff00">endfunction</font>
</pre>
</body>
</html>
